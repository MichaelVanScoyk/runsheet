<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>CADReport</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    <script>
      // Auto-reconnect: detects server going down (deploy/restart)
      // and auto-reloads once it comes back. Retries every 5 seconds.
      (function() {
        var checking = false;
        var serverWasDown = false;

        function checkServer() {
          fetch('/api/settings/station/timezone', { method: 'GET', cache: 'no-store' })
            .then(function(res) {
              if (res.ok && serverWasDown) {
                // Server is back â€” reload
                window.location.reload();
              } else if (!res.ok) {
                // Cloudflare 502/503 or server error
                serverWasDown = true;
              }
            })
            .catch(function() {
              // Server unreachable
              serverWasDown = true;
            });
        }

        // Poll every 5 seconds
        setInterval(checkServer, 5000);
      })();
    </script>
  </body>
</html>
